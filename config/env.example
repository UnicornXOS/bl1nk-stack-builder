# =============================================================================
# bl1nk-agent-builder Environment Configuration
# =============================================================================
# Copy this file to .env and update with your actual values
# Never commit .env to version control

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Neon Postgres connection string
# Format: postgresql://user:password@host:port/database
DB_DSN=postgresql://user:password@neon-host.neon.tech:5432/bl1nk

# Database connection pool settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_TIMEOUT=30

# =============================================================================
# FASTAPI CORE CONFIGURATION
# =============================================================================

# Server settings
FASTAPI_HOST=0.0.0.0
FASTAPI_PORT=8000
FASTAPI_WORKERS=1

# API base URL (for webhooks and callbacks)
FASTAPI_URL=https://api.bl1nk.site

# CORS settings
CORS_ORIGINS=["https://bl1nk.site", "http://localhost:3000"]
CORS_CREDENTIALS=true

# Security
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440

# API Keys
ADMIN_API_KEY=your-admin-api-key-for-sensitive-operations

# =============================================================================
# UPSTASH REDIS CONFIGURATION
# =============================================================================

# Redis connection
UPSTASH_REDISURL=rediss://:token@global.upstash.io:6379

# Queue settings
UPSTASH_QUEUE_NAME=bl1nk_tasks
UPSTASH_MAX_WORKERS=10
UPSTASH_POLL_INTERVAL=1

# Cache settings
UPSTASH_CACHE_TTL=3600
UPSTASH_EMBEDDING_CACHE_TTL=86400

# Rate limiting
UPSTASH_RATE_LIMIT_WINDOW=60
UPSTASH_RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# LLM PROVIDERS CONFIGURATION
# =============================================================================

# OpenRouter (Primary provider)
OPENROUTER_TOKEN=your-openrouter-api-token
OPENROUTER_API_URL=https://openrouter.ai/api/v1
OPENROUTER_TIMEOUT=30
OPENROUTER_MAX_RETRIES=3

# Cloudflare Gateway (Secondary provider)
CLOUDFLARE_GATEWAY_URL=https://gateway.ai.cloudflare.com/v1/your-account-id/
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_TIMEOUT=30
CLOUDFLARE_MAX_RETRIES=2

# Bedrock (Tertiary provider)
BEDROCK_TOKEN=your-aws-bedrock-token
BEDROCK_REGION=us-east-1
BEDROCK_TIMEOUT=60
BEDROCK_MAX_RETRIES=5

# =============================================================================
# EMBEDDING CONFIGURATION
# =============================================================================

# Default embedding model and provider
EMBED_ENDPOINT=https://openrouter.ai/api/v1/embeddings
EMBED_MODEL=gamma-300
EMBED_VECTOR_DIM=768
EMBED_CACHE_TTL=86400

# Alternative embedding models
COHERE_EMBED_MODEL=embed-multilingual-v3.0
COHERE_EMBED_DIM=1024

# =============================================================================
# OBJECT STORAGE CONFIGURATION
# =============================================================================

# Cloudflare R2 (Primary storage)
R2_ACCOUNT_ID=your-r2-account-id
R2_ACCESS_KEY=your-r2-access-key
R2_SECRET_KEY=your-r2-secret-key
R2_BUCKET_NAME=bl1nk-artifacts
R2_REGION=wnam

# Alternative: AWS S3
S3_BUCKET=your-s3-bucket-name
S3_REGION=us-east-1
S3_ACCESS_KEY=your-s3-access-key
S3_SECRET_KEY=your-s3-secret-key

# =============================================================================
# OAUTH / INTEGRATIONS CONFIGURATION
# =============================================================================

# Slack Integration
SLACK_SIGNING_SECRET=your-slack-signing-secret
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_APP_TOKEN=xapp-your-slack-app-token

# GitHub App Integration
GITHUB_APP_ID=your-github-app-id
GITHUB_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\n...\n-----END RSA PRIVATE KEY-----"
GITHUB_WEBHOOK_SECRET=your-github-webhook-secret

# Poe Integration
POE_API_KEY=your-poe-api-key
POE_WEBHOOK_SECRET=your-poe-webhook-secret

# Manus Integration
MANUS_API_KEY=your-manus-api-key
MANUS_WEBHOOK_SECRET=your-manus-webhook-secret

# Clerk Authentication
CLERK_API_KEY=your-clerk-public-key
CLERK_SECRET_KEY=your-clerk-secret-key
CLERK_JWT_KEY=your-clerk-jwt-key

# =============================================================================
# SECURITY & ENCRYPTION
# =============================================================================

# Encryption for sensitive data
ENCRYPTION_KEY=your-32-character-encryption-key
ENCRYPTION_ALGORITHM=AES-256-GCM

# API rate limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20

# Provider cost limits (USD)
COST_LIMIT_PER_TASK=0.50
COST_LIMIT_PER_USER_DAILY=10.00
COST_LIMIT_PER_USER_MONTHLY=100.00

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_SERVICE_NAME=bl1nk-agent-builder
OTEL_SERVICE_VERSION=1.0.0

# Sentry Error Tracking
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level
LOG_LEVEL=INFO
LOG_FORMAT=json

# File logging
LOG_FILE_PATH=/var/log/bl1nk/app.log
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_BACKUP_COUNT=5

# Database logging
LOG_SQL_QUERIES=false
LOG_SLOW_QUERIES_THRESHOLD=1.0

# =============================================================================
# ENVIRONMENT & DEPLOYMENT
# =============================================================================

# Environment type
ENV=development
ENVIRONMENT=development

# Feature flags
FEATURE_RAG_ENABLED=true
FEATURE_MCP_ENABLED=true
FEATURE_SKILLS_ENABLED=true
FEATURE_MULTI_AGENT_ENABLED=false

# Development settings
DEBUG=true
RELOAD=true
HOT_RELOAD=true

# =============================================================================
# PROVIDER ROUTING CONFIGURATION
# =============================================================================

# Provider priority (1=highest, 10=lowest)
PROVIDER_PRIORITY_OPENROUTER=1
PROVIDER_PRIORITY_CLOUDFLARE=2
PROVIDER_PRIORITY_BEDROCK=3

# Failover settings
FAILOVER_ENABLED=true
FAILOVER_MAX_ATTEMPTS=3
FAILOVER_BACKOFF_BASE=0.5
FAILOVER_BACKOFF_FACTOR=2.0

# =============================================================================
# VECTOR SEARCH CONFIGURATION
# =============================================================================

# pgvector settings
VECTOR_INDEX_TYPE=ivfflat
VECTOR_INDEX_LISTS=100
VECTOR_SIMILARITY_THRESHOLD=0.8

# RAG settings
RAG_CHUNK_SIZE=1000
RAG_CHUNK_OVERLAP=200
RAG_TOP_K=5
RAG_RERANK_ENABLED=true

# =============================================================================
# TASK PROCESSING CONFIGURATION
# =============================================================================

# Task queue settings
TASK_QUEUE_CONCURRENCY=5
TASK_TIMEOUT=300
TASK_RETRY_ATTEMPTS=3
TASK_RETRY_DELAY=5

# SSE settings
SSE_HEARTBEAT_INTERVAL=30
SSE_TIMEOUT=3600

# =============================================================================
# SKILLS & MCP CONFIGURATION
# =============================================================================

# Skills registry
SKILLS_REGISTRY_PATH=/app/skills
SKILLS_AUTO_DISCOVERY=true
SKILLS_TIMEOUT=60

# MCP tools
MCP_TOOLS_REGISTRY_PATH=/app/mcp-tools
MCP_TOOLS_AUTO_DISCOVERY=true
MCP_TOOLS_TIMEOUT=120

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

# Redis cache settings
CACHE_DEFAULT_TTL=3600
CACHE_USER_DATA_TTL=1800
CACHE_EMBEDDING_TTL=86400
CACHE_PROVIDER_RESPONSE_TTL=300

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================

# Webhook verification
WEBHOOK_SIGNATURE_HEADER_PREFIX=X-Webhook
WEBHOOK_SIGNATURE_ALGORITHM=SHA256
WEBHOOK_SIGNATURE_TOLERANCE=300

# Webhook processing
WEBHOOK_MAX_PAYLOAD_SIZE=10485760
WEBHOOK_PROCESSING_TIMEOUT=30
WEBHOOK_QUEUE_SIZE=1000

# =============================================================================
# BILLING & USAGE TRACKING
# =============================================================================

# Billing settings
BILLING_ENABLED=true
BILLING_CURRENCY=USD
BILLING_TAX_RATE=0.0

# Usage tracking
USAGE_TRACKING_ENABLED=true
USAGE_RETENTION_DAYS=365

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================

# Test database
TEST_DB_DSN=postgresql://user:password@localhost:5432/bl1nk_test

# Mock providers (for testing)
MOCK_OPENROUTER=false
MOCK_BEDROCK=false
MOCK_CLOUDFLARE=false

# Test data
SEED_TEST_DATA=false
SEED_TEST_USERS=5
SEED_TEST_DOCUMENTS=10